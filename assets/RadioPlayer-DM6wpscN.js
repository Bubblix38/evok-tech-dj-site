import{j as e}from"./ui-gJEqDpdJ.js";import{r as t}from"./vendor-Ber6wfih.js";import{u as a,a as s,B as r,L as i,P as n,b as l,V as o,c as d,d as c}from"./index-eMdp0EjA.js";function u({className:u=""}){const[m,h]=t.useState(!1),[x,g]=t.useState(.7),[f,v]=t.useState(!1),[p,y]=t.useState(!1),[j,b]=t.useState(0),w=[{title:"Burn (Craig Knight & Lewis Roper Remix)",artist:"Usher",duration:180},{title:"One In A Million",artist:"Bebe Rexha & David Guetta",duration:240},{title:"Won't Be Possible",artist:"Tiësto, Odd Mob, Goodboys",duration:320},{title:"Drinkin'",artist:"Joel Corry, MK & Rita Ora",duration:200},{title:"Sing Hallelujah (Dakaos & Calin Remix)",artist:"Dr. Alban",duration:245},{title:"Rainfall (Praise You)",artist:"Tom Santa",duration:185},{title:"Rain In Ibiza",artist:"Felix Jaehn & The Stickmen Project feat. Calum Scott",duration:270},{title:"Midnight (The Hanging Tree)",artist:"HOSH & 1979 feat. Jalja",duration:215},{title:"It's Not Right But It's Okay",artist:"Felix Jaehn, Whitney Houston",duration:390},{title:"Aire",artist:"Steve Aoki, Farruko",duration:300}],[N,E]=t.useState("EVOK.FM - Live DJ Mixes"),[L,k]=t.useState(null),S=t.useRef(null),O="https://breakz-high.rautemusik.fm/",{data:F,refetch:I}=a({queryKey:["/api/radio/now-playing"],refetchInterval:3e4,enabled:m});s({mutationFn:async({title:e,artist:t})=>{const a=await fetch("/api/radio/download-current",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e,artist:t})});if(!a.ok)throw new Error("Failed to get download links");return a.json()}}),t.useEffect(()=>{const e=S.current;let t;return e&&(e.volume=x,e.preload="none"),m&&(t=setInterval(()=>{b(e=>(e+1)%w.length)},3e4)),()=>{t&&clearInterval(t)}},[m,w.length]),t.useEffect(()=>{const e=S.current;if(!e)return;const t=()=>{y(!0),k(null)},a=()=>{y(!1),k(null)},s=e=>{y(!1),k("Falha ao conectar com a rádio"),h(!1)},r=()=>{y(!1)},i=()=>{m&&!e.ended&&h(!1)},n=()=>{h(!0)};return e.addEventListener("loadstart",t),e.addEventListener("canplay",a),e.addEventListener("error",s),e.addEventListener("loadeddata",r),e.addEventListener("pause",i),e.addEventListener("play",n),()=>{e.removeEventListener("loadstart",t),e.removeEventListener("canplay",a),e.removeEventListener("error",s),e.removeEventListener("loadeddata",r),e.removeEventListener("pause",i),e.removeEventListener("play",n)}},[m]);const C=()=>{const e=S.current;e&&(f?(e.volume=x,v(!1)):(e.volume=0,v(!0)))};return t.useEffect(()=>{F&&m&&E(`${F.artist} - ${F.title}`)},[F,m]),e.jsxs("div",{className:`${u.includes("fixed")?"fixed bottom-0 left-0 right-0 z-50 bg-gray-900/95 backdrop-blur-md border-t border-gray-700 shadow-2xl":u||"bg-gray-900/95 backdrop-blur-md border border-gray-700 rounded-lg shadow-2xl p-4"}`,"data-testid":"radio-player",children:[e.jsx("audio",{ref:S,preload:"none",crossOrigin:"anonymous",playsInline:!0,controls:!1,autoPlay:!1}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[e.jsx(r,{onClick:async()=>{const e=S.current;if(e)try{m?(e.pause(),h(!1),y(!1)):(y(!0),k(null),e.src!==O&&(e.src=O,e.volume=f?0:x,e.load()),await e.play(),h(!0),E("EVOK.FM - Live DJ Mixes"),I())}catch(t){k("Erro ao reproduzir. Verifique sua conexão."),h(!1)}finally{y(!1)}},disabled:p,className:"w-12 h-12 rounded-full bg-white hover:bg-gray-100 text-gray-900 transition-all duration-300 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center p-0","data-testid":"button-radio-play",children:p?e.jsx(i,{size:"sm"}):m?e.jsx(n,{className:"w-5 h-5"}):e.jsx(l,{className:"w-5 h-5 ml-0.5"})}),e.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[e.jsx("span",{className:"font-semibold text-white",children:"EVOK.FM"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full "+(m?"bg-green-400 animate-pulse":"bg-gray-500")}),e.jsx("span",{className:"text-xs text-gray-400 font-medium",children:p?"Verbindung...":m?"LIVE":"Offline"})]})]})]}),e.jsx("div",{className:"hidden md:flex items-center gap-3 flex-1 max-w-md mx-8",children:e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-1",children:e.jsx("div",{className:"bg-orange-500 h-1 rounded-full transition-all duration-1000",style:{width:m?"45%":"0%"}})})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[e.jsx(r,{variant:"ghost",size:"icon",onClick:C,className:"text-gray-400 hover:text-white hover:bg-gray-800 rounded-full w-8 h-8",children:f||0===x?e.jsx(o,{className:"w-3 h-3"}):x<.5?e.jsx(d,{className:"w-3 h-3"}):e.jsx(c,{className:"w-3 h-3"})}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:f?0:x,onChange:e=>{const t=parseFloat(e.target.value);g(t),S.current&&(S.current.volume=t),v(0===t)},className:"w-20 h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer slider",style:{background:`linear-gradient(to right, #f97316 0%, #f97316 ${100*(f?0:x)}%, #374151 ${100*(f?0:x)}%, #374151 100%)`}})]}),e.jsx(r,{variant:"ghost",size:"icon",onClick:C,className:"md:hidden text-gray-400 hover:text-white hover:bg-gray-800 rounded-full w-10 h-10",children:f||0===x?e.jsx(o,{className:"w-4 h-4"}):x<.5?e.jsx(d,{className:"w-4 h-4"}):e.jsx(c,{className:"w-4 h-4"})})]})]}),L&&e.jsx("div",{className:"px-4 pb-2",children:e.jsx("p",{className:"text-red-400 text-xs text-center",children:L})})]})}export{u as default};
